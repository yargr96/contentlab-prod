"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var Calculator=function(){function e(t){var n=t.range,i=t.socials,o=t.flask,r=t.countContainer;_classCallCheck(this,e),this._range=n,this._socials=i,this._flask=o,this._countContainer=r,this._onChange=this._onChange.bind(this),n.onChange=this._onChange,i.onChange=this._onChange,this._setMaxPrice(),this._render()}return _createClass(e,[{key:"_onChange",value:function(){this._render()}},{key:"_render",value:function(){this._countContainer.textContent=this.priceFormatted,this._flask.fullness=this._priceFullness}},{key:"_setMaxPrice",value:function(){var e=this._range.max,t=this._socials.totalCount;this._maxPrice=400*e*(t-(t-1)/2)+400*e}},{key:"price",get:function(){var e=this._range.value,t=this._socials.value,n=t.count,i=t.designDecoration;if(!n)return 0;var o=0;return i&&(o=400*e),400*e*(n-(n-1)/2)+o}},{key:"priceFormatted",get:function(){var e=0;return String(this.price).split("").reduceRight(function(t,n){return e++,e%3==0?n+" "+t:n+t})}},{key:"_priceFullness",get:function(){return this.price/this._maxPrice}}]),e}(),FlaskSection=function(){function e(t){_classCallCheck(this,e),this._section=t,this._DEFAUTL_WIDTH=505,this._DEFAUTL_HEIGHT=550,this._DEFAUTL_PADDING_TOP=102,this._proportion=this._DEFAUTL_HEIGHT/this._DEFAUTL_WIDTH,this._paddingProportion=this._DEFAUTL_PADDING_TOP/this._DEFAUTL_WIDTH,this._setProportions=this._setProportions.bind(this),this._setProportions(),window.addEventListener("resize",this._setProportions)}return _createClass(e,[{key:"_setProportions",value:function(){var e=parseFloat(getComputedStyle(this._section).width);this._section.style.height=e*this._proportion+"px",this._section.style.paddingTop=e*this._paddingProportion+"px"}}]),e}(),Flask=function(){function e(t){var n=t.flask,i=t.fullness,o=void 0===i?0:i;_classCallCheck(this,e),this._flask=n,this._fullness=o,this._filler=this._flask.querySelector(".flask__full"),this._MAX_FILLER_HEIGHT=100,this._MIN_FILLER_HEIGHT=14,this._fillerHeightRange=this._MAX_FILLER_HEIGHT-this._MIN_FILLER_HEIGHT,this._setFillerHeight(),this._DEFAULT_WIDTH=505,this._DEFAULT_HEIGHT=379,this._proportion=this._DEFAULT_HEIGHT/this._DEFAULT_WIDTH,this._setProportions=this._setProportions.bind(this),this._setProportions(),window.addEventListener("resize",this._setProportions)}return _createClass(e,[{key:"_setFillerHeight",value:function(){var e;e=0===this._fullness?0:this._fillerHeightRange*this._fullness+this._MIN_FILLER_HEIGHT,this._filler.style.height=e+"%"}},{key:"_setProportions",value:function(){var e=parseFloat(getComputedStyle(this._flask).width);this._flask.style.height=e*this._proportion+"px"}},{key:"fullness",set:function(e){this._fullness=e,this._setFillerHeight()}}]),e}(),Range=function(){function e(t){var n=t.rangeNode,i=t.min,o=t.max,r=t.step,a=t.value,s=t.onChange;_classCallCheck(this,e),this._rangeNode=n,this.min=i,this.max=o,this._step=r,s&&(this.onChange=s),this._filled=this._rangeNode.querySelector(".range__filled"),this._thumb=this._rangeNode.querySelector(".range__thumb"),this._count=this._rangeNode.querySelector(".range__count"),this._onMouseDown=this._onMouseDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._thumb.addEventListener("mousedown",this._onMouseDown),this._thumb.addEventListener("touchstart",this._onMouseDown),window.addEventListener("mouseup",this._onMouseUp),window.addEventListener("touchend",this._onMouseUp),this._stepsCount=(this.max-this.min)/this._step,this.value=void 0===a?this.min:a,this._setRangeCoordinates=this._setRangeCoordinates.bind(this),this._setRangeCoordinates(),window.addEventListener("resize",this._setRangeCoordinates),this._setThumbPosition(),this._mousePressed=!1}return _createClass(e,[{key:"_setRangeCoordinates",value:function(){var e=this._rangeNode.getBoundingClientRect(),t=e.left,n=e.right,i=n-t;this._leftRangeCoordinate=t,this._stepLength=i/this._stepsCount}},{key:"_onMouseDown",value:function(e){e.target.classList.contains("range__thumb")&&(this._mousePressed||(window.addEventListener("mousemove",this._onMouseMove),window.addEventListener("touchmove",this._onMouseMove),document.body.classList.add("not-selectable"),this._mousePressed=!0))}},{key:"_onMouseMove",value:function(e){if(this._mousePressed){var t=e.pageX||e.changedTouches[0].pageX,n=t-this._leftRangeCoordinate,i=Math.round(n/this._stepLength)*this._step+this.min;i<this.min&&(i=this.min),i>this.max&&(i=this.max),this.value=i}}},{key:"_onMouseUp",value:function(){window.removeEventListener("mousemove",this._onMouseMove),document.body.classList.remove("not-selectable"),this._mousePressed=!1}},{key:"_setThumbPosition",value:function(){var e=(this._value-this.min)*this._stepLength/this._step;this._filled.style.width=e+"px",this._thumb.style.left=e+"px"}},{key:"value",get:function(){return this._value},set:function(e){this._value=e,this._setThumbPosition(),this._count.textContent=e,this.onChange&&this.onChange(e)}}]),e}(),Socials=function(){function e(t){var n=this,i=t.socialsList,o=t.designCheckbox,r=t.onChange;_classCallCheck(this,e),this._socialsList=i,this._designCheckbox=o,r&&(this.onChange=r),this._onSocialsChange=this._onSocialsChange.bind(this),this._onDesignDecorationChange=this._onDesignDecorationChange.bind(this),this._socialsList.forEach(function(e){e.addEventListener("change",n._onSocialsChange)}),this._designCheckbox.addEventListener("change",this._onDesignDecorationChange),this._checkSocials(),this._checkDesignDecoration()}return _createClass(e,[{key:"_checkSocials",value:function(){var e=0;this._socialsList.forEach(function(t){t.checked&&e++}),this._socialsCount=e}},{key:"_checkDesignDecoration",value:function(){this._designDecoration=this._designCheckbox.checked}},{key:"_onSocialsChange",value:function(){this._checkSocials(),this.onChange&&this.onChange(this.value)}},{key:"_onDesignDecorationChange",value:function(){this._checkDesignDecoration(),this.onChange&&this.onChange(this.value)}},{key:"value",get:function(){return{count:this._socialsCount,designDecoration:this._designDecoration}}},{key:"totalCount",get:function(){return this._socialsList.length}}]),e}(),popup=function(e){var t=e.linkToPopupSelector,n=e.closePopupSelector,i=e.popupSelector,o=document.querySelectorAll(t),r=document.querySelectorAll(n),a=document.querySelector(i),s=document.querySelector(".page-wrapper"),u=function(){a.style.display=null,requestAnimationFrame(function(){return a.classList.add("active")});var e=window.innerWidth-document.body.getBoundingClientRect().width;s.classList.add("page-wrapper_blured"),document.body.classList.add("overflow-hidden"),document.documentElement.classList.add("overflow-hidden"),document.body.style.paddingRight=e+"px"},c=function(){a.classList.remove("active"),s.classList.remove("page-wrapper_blured"),setTimeout(function(){a.style.display="none",document.body.classList.remove("overflow-hidden"),document.documentElement.classList.remove("overflow-hidden"),document.body.style.paddingRight=null},200)};o.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),u()})}),r.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),c()})})},submitForm=function(){var e=document.querySelector(".request-form"),t=function(e){e.preventDefault();var t=this.elements,n=t.name.value,i=t.phone.value,o=t.email.value,r=new URLSearchParams;r.append("name",n),r.append("phone",i),r.append("email",o),axios.post("/mail.php",r).then(function(e){console.log(e)}).catch(function(e){console.log(e)})};e.addEventListener("submit",t)};document.addEventListener("DOMContentLoaded",function(){var e=new Range({rangeNode:document.querySelector(".range"),min:13,max:69,step:4,value:21}),t=new Socials({socialsList:document.querySelectorAll(".checkbox__input_social"),designCheckbox:document.querySelector(".checkbox__input_design")}),n=new Flask({flask:document.querySelector(".flask")});new FlaskSection(document.querySelector(".calculator-section__flask-section")),new Calculator({range:e,socials:t,flask:n,countContainer:document.querySelector(".calculator-section__total-count")}),popup({linkToPopupSelector:".popup-link",closePopupSelector:".close-popup",popupSelector:"#request-popup"}),document.querySelectorAll(".request-form__input_phone").forEach(function(e){new Inputmask("+7(999)999-99-99",{showMaskOnHover:!1}).mask(e)}),submitForm()});